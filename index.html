<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voter CSV Generator üöÄ</title>
<style>
body { font-family: Arial,sans-serif; background:#f7f7f7; padding:20px; }
h2 { text-align:center; color:#333; }
textarea { width:100%; height:300px; padding:10px; font-size:14px; margin-bottom:15px; box-sizing:border-box; resize: vertical; }
.button-container { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:20px; }
button { flex:1; padding:12px; font-size:16px; cursor:pointer; border:none; border-radius:5px; color:white; transition:.3s; }
#generateButton { background:#007bff; } #generateButton:hover { background:#0056b3; }
#copyButton { background:#28a745; } #copyButton:hover { background:#218838; }
#downloadButton { background:#ffc107; color:#000; } #downloadButton:hover { background:#e0a800; }
#outputCSV { width:100%; height:300px; padding:10px; font-family:Consolas,monospace; font-size:13px; border:1px solid #ddd; box-sizing:border-box; white-space:pre-wrap; }
</style>
</head>
<body>

<h2>Voter CSV Generator üöÄ</h2>
<p>Raw voter text ‡§Ø‡§π‡§æ‡§Å paste ‡§ï‡§∞‡•á‡§Ç:</p>
<textarea id="inputText" placeholder="Raw voter text paste ‡§ï‡§∞‡•á‡§Ç..."></textarea>

<div class="button-container">
<button id="generateButton">CSV Generate ‡§ï‡§∞‡•á‡§Ç</button>
<button id="copyButton" disabled>üìã Copy CSV</button>
<button id="downloadButton" disabled>‚¨áÔ∏è Download CSV</button>
</div>

<h3>Generated CSV:</h3>
<textarea id="outputCSV" readonly placeholder="CSV output ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡•á‡§ó‡§æ..."></textarea>

<script>
function generateCSV(text){
    const lines = text.split(/\r?\n/).map(l=>l.trim()).filter(l=>l!=="");
    const csvRows = [];
    const header = ["SerialNo","EPIC_NO","PartNo","VoterName","RelationName","RelationType","HouseNo","Age","Gender"];
    csvRows.push(header.join(","));

    for(let line of lines){
        // Skip empty lines
        if(!line) continue;

        // Split by commas (already comma separated)
        const parts = line.split(",");
        // Ensure exactly 9 columns
        while(parts.length<9) parts.push("NA");
        // Add quotes if field contains comma
        const safeParts = parts.map(p=>p.includes(",") || p.includes('"') ? `"${p.replace(/"/g,'""')}"` : p);
        csvRows.push(safeParts.join(","));
    }

    return csvRows.join("\n");
}

document.getElementById("generateButton").addEventListener("click", ()=>{
    const input = document.getElementById("inputText").value;
    if(!input.trim()){ alert("Raw voter text paste ‡§ï‡§∞‡•á‡§Ç!"); return; }
    const csv = generateCSV(input);
    document.getElementById("outputCSV").value = csv;
    document.getElementById("copyButton").disabled = false;
    document.getElementById("downloadButton").disabled = false;
});

document.getElementById("copyButton").addEventListener("click", ()=>{
    const output = document.getElementById("outputCSV");
    output.select();
    document.execCommand("copy");
    alert("CSV clipboard ‡§Æ‡•á‡§Ç copy ‡§π‡•ã ‡§ó‡§Ø‡§æ! üìã");
});

document.getElementById("downloadButton").addEventListener("click", ()=>{
    const csvData = document.getElementById("outputCSV").value;
    const blob = new Blob([csvData], {type:"text/csv;charset=utf-8;"});
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "voter_list.csv";
    link.click();
});
</script>
</body>
</html>
