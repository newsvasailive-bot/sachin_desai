<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Voter List Auto Extractor</title>
<style>
body { font-family: Arial; background:#f2f2f2; padding:20px; }
textarea { width:100%; height:250px; padding:10px; font-size:16px; }
button { padding:10px 20px; font-size:18px; margin-top:10px; cursor:pointer; }
table { width:100%; border-collapse: collapse; margin-top:20px; background:#fff; }
th, td { border:1px solid #ccc; padding:8px; text-align:left; }
th { background:#ddd; }
</style>
</head>
<body>

<h2>Voter List Auto Extractor (100 Lines Supported)</h2>

<textarea id="inputText" placeholder="Yaha voter list paste karein..."></textarea>
<br>
<button onclick="processData()">Convert to CSV</button>

<div id="tableContainer"></div>

<script>
function processData() {
    let text = document.getElementById("inputText").value;

    let lines = text.split("\n").map(l => l.trim()).filter(l => l);

    let finalData = [];
    let serial = 1;

    for (let i = 0; i < lines.length; i++) {
        let line = lines[i];

        // Voter ID extract
        let voterID = line.match(/[A-Z]{3}\d{7}/)?.[0] || "NA";

        // Part Number extract
        let part = line.match(/\d{1,3}\/\d{1,3}\/\d{1,4}/)?.[0] || "NA";

        // Name extract
        let name = lines[i + 1]?.includes("नांव") ? lines[i + 1].replace(/.*:/, "").trim() : "NA";

        // Father/Husband Name extract
        let relation = (lines[i + 2]?.includes("वडिलांचे") || lines[i + 2]?.includes("पतीचे")) 
                       ? lines[i + 2].replace(/.*:/, "").trim()
                       : "NA";

        // Address / House No extract
        let addressLine = lines[i + 3]?.includes("घर क्रमांक")
                          ? lines[i + 3].replace(/.*:/, "").trim()
                          : "NA";

        // Age extract
        let age = line.match(/\b\d{2}\b/)?.[0] || "NA";

        // Gender extract
        let gender = line.includes("Male") ? "Male" : line.includes("Female") ? "Female" : "NA";

        finalData.push({
            Serial: serial++,
            VoterID: voterID,
            PartNo: part,
            Name: name,
            Father: relation,
            Address: addressLine,
            Age: age,
            Gender: gender
        });
    }

    generateTable(finalData);
    downloadCSV(finalData);
}

function generateTable(data) {
    let html = "<table><tr><th>Serial</th><th>VoterID</th><th>Part</th><th>Name</th><th>Father/Husband</th><th>Address</th><th>Age</th><th>Gender</th></tr>";

    data
