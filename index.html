<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>CSV Viewer Powerful Script (Fixed)</title>

<style>
    body{
        font-family: Arial, sans-serif;
        background:#f2f2f2;
        padding:20px;
    }
    h2{
        text-align:center;
    }
    #fileInput{
        margin-bottom:20px;
        display:block;
    }
    table{
        width:100%;
        border-collapse:collapse;
        background:white;
    }
    th, td{
        border:1px solid #444;
        padding:8px;
        font-size:14px;
    }
    th{
        background:#222;
        color:white;
        position:sticky;
        top:0;
    }
    tr:nth-child(even){
        background:#f9f9f9;
    }

    /* Mobile scroll */
    .table-container{
        width:100%;
        overflow-x:auto;
    }
</style>
</head>

<body>

<h2>Powerful CSV Viewer (Fixed Version)</h2>

<input type="file" id="fileInput" accept=".csv">

<div class="table-container">
    <table id="csvTable"></table>
</div>

<script>
document.getElementById("fileInput").addEventListener("change", function(e){
    let file = e.target.files[0];
    if(!file){
        alert("कृपया CSV फ़ाइल चुनें");
        return;
    }

    let reader = new FileReader();
    reader.onload = function(event){
        let text = event.target.result;
        processCSV(text);
    };
    reader.readAsText(file, "UTF-8");
});


function processCSV(csv) {
    csv = csv.replace(/\r/g, "");
    let rows = csv.split("\n").filter(x => x.trim() !== "");

    let table = document.getElementById("csvTable");
    table.innerHTML = "";

    rows.forEach((row, i) => {
        let tr = document.createElement("tr");
        let cols = parseCSV(row);

        cols.forEach(col => {
            let cell = document.createElement(i === 0 ? "th" : "td");
            cell.textContent = col.trim();
            tr.appendChild(cell);
        });

        table.appendChild(tr);
    });

    alert("CSV Loaded Successfully!");
}


function parseCSV(line) {
    const result = [];
    let current = "";
    let insideQuotes = false;

    for (let i = 0; i < line.length; i++) {
        const char = line[i];

        if (char === '"') {
            insideQuotes = !insideQuotes;
        }
        else if (char === ',' && !insideQuotes) {
            result.push(current);
            current = "";
        }
        else {
            current += char;
        }
    }
    result.push(current);

    return result;
}
</script>

</body>
</html>
